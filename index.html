<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TuCitaSegura - Encuentra tu conexión perfecta</title>
  <link rel="stylesheet" href="./webapp/css/output.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0369a1 100%);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      min-height: 100vh;
    }

    .glass {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .hero-gradient {
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .float-animation {
      animation: float 6s ease-in-out infinite;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in-up {
      animation: fadeInUp 0.8s ease-out;
    }
  </style>
</head>
<body class="text-white">
  <script>
    (function () {
      var h = location.hostname;
      if (h.indexOf('www.') === 0) {
        var dest = location.protocol + '//' + h.replace(/^www\./, '') + location.pathname + location.search + location.hash;
        location.replace(dest);
      }
    })();
  </script>

  <!-- Header -->
  <header class="glass fixed top-0 w-full z-50">
    <nav class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="/" class="flex items-center gap-2">
        <i class="fas fa-heart-circle-check text-blue-400 text-2xl"></i>
        <span class="font-bold text-xl">TuCitaSegura</span>
      </a>
      <div class="flex items-center gap-4">
        <a href="/webapp/login.html" class="hover:text-blue-300 transition font-semibold">
          Iniciar Sesión
        </a>
        <a href="/webapp/register.html" class="bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 px-6 py-2 rounded-lg font-semibold transition">
          Registrarse
        </a>
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <main class="pt-24 pb-12 px-4">
    <div class="max-w-7xl mx-auto">

      <!-- Hero Content -->
      <div class="text-center mb-20 fade-in-up">
        <div class="mb-8 float-animation inline-block">
          <i class="fas fa-heart-circle-check text-blue-400 text-8xl"></i>
        </div>
        <h1 class="text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
          TuCitaSegura
        </h1>
        <p class="text-xl md:text-2xl text-slate-300 mb-8 max-w-3xl mx-auto">
          Encuentra tu conexión perfecta con seguridad, transparencia y respeto
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          <a href="/webapp/buscar-usuarios.html" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 px-8 py-4 rounded-lg font-semibold text-lg transition transform hover:scale-105">
            <i class="fas fa-search mr-2"></i>Explorar Usuarios
          </a>
          <a href="#features" class="glass px-8 py-4 rounded-lg font-semibold text-lg transition transform hover:scale-105">
            <i class="fas fa-info-circle mr-2"></i>Saber Más
          </a>
        </div>
        <div class="mt-6 flex flex-col sm:flex-row gap-3 justify-center items-center">
          <button id="quickLoginGonzalo" class="glass px-6 py-3 rounded-lg font-semibold transition hover:scale-105">Entrar como Gonzalo (masculino)</button>
          <button id="quickLoginCasita" class="glass px-6 py-3 rounded-lg font-semibold transition hover:scale-105">Entrar como La Casita (femenino)</button>
        </div>
      </div>

      <!-- Features Section -->
      <div id="features" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-20">
        <div class="glass rounded-2xl p-8 text-center fade-in-up">
          <div class="text-5xl mb-4">
            <i class="fas fa-shield-heart text-blue-400"></i>
          </div>
          <h3 class="text-2xl font-bold mb-3">100% Seguro</h3>
          <p class="text-slate-300">
            Verificación de identidad, reputación transparente y protección de datos garantizada
          </p>
        </div>

        <div class="glass rounded-2xl p-8 text-center fade-in-up" style="animation-delay: 0.2s;">
          <div class="text-5xl mb-4">
            <i class="fas fa-search-plus text-purple-400"></i>
          </div>
          <h3 class="text-2xl font-bold mb-3">Búsqueda Avanzada</h3>
          <p class="text-slate-300">
            Filtros inteligentes por edad, ciudad, reputación y más para encontrar tu match ideal
          </p>
        </div>

        <div class="glass rounded-2xl p-8 text-center fade-in-up" style="animation-delay: 0.4s;">
          <div class="text-5xl mb-4">
            <i class="fas fa-star text-yellow-400"></i>
          </div>
          <h3 class="text-2xl font-bold mb-3">Sistema de Reputación</h3>
          <p class="text-slate-300">
            Badges de Bronce, Plata, Oro y Platino basados en comportamiento y feedback
          </p>
        </div>
      </div>

      <!-- Stats Section -->
      <div class="glass rounded-2xl p-12 mb-20 text-center">
        <h2 class="text-3xl font-bold mb-8">
          <i class="fas fa-chart-line mr-2 text-blue-400"></i>
          Estadísticas de la Plataforma
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <div class="text-5xl font-bold text-blue-400 mb-2">10K+</div>
            <div class="text-slate-300">Usuarios Activos</div>
          </div>
          <div>
            <div class="text-5xl font-bold text-pink-400 mb-2">5K+</div>
            <div class="text-slate-300">Matches Exitosos</div>
          </div>
          <div>
            <div class="text-5xl font-bold text-green-400 mb-2">95%</div>
            <div class="text-slate-300">Satisfacción</div>
          </div>
        </div>
      </div>

      <!-- How it Works -->
      <div class="mb-20">
        <h2 class="text-4xl font-bold text-center mb-12">
          <i class="fas fa-lightbulb mr-2 text-yellow-400"></i>
          ¿Cómo Funciona?
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
          <div class="glass rounded-2xl p-6 text-center">
            <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-2xl font-bold mx-auto mb-4">1</div>
            <h3 class="font-bold mb-2">Regístrate</h3>
            <p class="text-sm text-slate-300">Crea tu perfil y verifica tu email</p>
          </div>
          <div class="glass rounded-2xl p-6 text-center">
            <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center text-2xl font-bold mx-auto mb-4">2</div>
            <h3 class="font-bold mb-2">Explora</h3>
            <p class="text-sm text-slate-300">Busca usuarios con filtros avanzados</p>
          </div>
          <div class="glass rounded-2xl p-6 text-center">
            <div class="w-16 h-16 bg-pink-500 rounded-full flex items-center justify-center text-2xl font-bold mx-auto mb-4">3</div>
            <h3 class="font-bold mb-2">Conecta</h3>
            <p class="text-sm text-slate-300">Envía solicitudes de cita</p>
          </div>
          <div class="glass rounded-2xl p-6 text-center">
            <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-2xl font-bold mx-auto mb-4">4</div>
            <h3 class="font-bold mb-2">Conoce</h3>
            <p class="text-sm text-slate-300">Agenda citas seguras</p>
          </div>
        </div>
      </div>

      <!-- CTA Section -->
      <div class="glass rounded-2xl p-12 text-center hero-gradient">
        <h2 class="text-4xl font-bold mb-4">
          ¿Listo para encontrar tu match perfecto?
        </h2>
        <p class="text-xl text-slate-300 mb-8">
          Únete a miles de personas que ya encontraron su conexión especial
        </p>
        <a href="/webapp/register.html" class="inline-block bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 px-10 py-4 rounded-lg font-semibold text-lg transition transform hover:scale-105">
          <i class="fas fa-heart mr-2"></i>Comenzar Ahora
        </a>
      </div>

    </div>
  </main>

  <!-- Footer -->
  <footer class="glass mt-20 py-8">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <div class="flex items-center justify-center gap-2 mb-4">
        <i class="fas fa-heart-circle-check text-blue-400 text-2xl"></i>
        <span class="font-bold text-xl">TuCitaSegura</span>
      </div>
      <p class="text-slate-400 mb-4">
        Encuentra conexiones auténticas con seguridad y respeto
      </p>
      <div class="flex justify-center gap-6 mb-4">
        <a href="#" class="text-slate-400 hover:text-blue-400 transition">
          <i class="fab fa-facebook text-2xl"></i>
        </a>
        <a href="#" class="text-slate-400 hover:text-pink-400 transition">
          <i class="fab fa-instagram text-2xl"></i>
        </a>
        <a href="#" class="text-slate-400 hover:text-blue-300 transition">
          <i class="fab fa-twitter text-2xl"></i>
        </a>
      </div>
      <p class="text-sm text-slate-500">
        © 2025 TuCitaSegura. Todos los derechos reservados.
      </p>
    </div>
  </footer>

  

  <!-- Backend Integration Script -->
  <script type="module">
    // Import API Service y Firebase Auth (modular)
    import { apiService } from './webapp/js/api-service.js';
    import { auth } from './webapp/js/firebase-config.js';
    
    class IndexPageManager {
      constructor() {
        this.init();
      }

      async init() {
        try {
          // Test backend connection
          await this.testBackendConnection();
          
          // Update UI based on backend status
          await this.updateBackendStatus();
          
          // Setup event listeners
          this.setupEventListeners();
          
        } catch (error) {
          console.error('Error initializing index page:', error);
        }
      }

      async testBackendConnection() {
        try {
          if (!apiService.isLocal) {
            return; // No mostrar estado backend en producción
          }
          const isAvailable = await apiService.isBackendAvailable();
          
          if (isAvailable) {
            console.log('✅ Backend connection successful');
            
            // Test health endpoint
            const health = await apiService.healthCheck();
            console.log('Backend health:', health);
            
            // Update UI to show backend is connected
            this.showBackendStatus(true, health);
            
          } else {
            this.showBackendStatus(false);
          }
          
        } catch (error) {
          console.error('❌ Backend connection failed:', error);
          if (apiService.isLocal) {
            this.showBackendStatus(false);
          }
        }
      }

      showBackendStatus(connected, health = null) {
        // Create status indicator
        const statusIndicator = document.createElement('div');
        statusIndicator.id = 'backend-status';
        statusIndicator.className = `fixed top-20 right-4 z-50 px-4 py-2 rounded-lg text-sm font-medium ${
          connected 
            ? 'bg-green-900/80 border border-green-600 text-green-300' 
            : 'bg-red-900/80 border border-red-600 text-red-300'
        }`;
        
        statusIndicator.innerHTML = `
          <div class="flex items-center gap-2">
            <div class="w-2 h-2 rounded-full ${connected ? 'bg-green-400' : 'bg-red-400'}"></div>
            <span>${connected ? 'Backend Conectado' : 'Backend Desconectado'}</span>
            ${health ? `<span class="text-xs opacity-75">v${health.version}</span>` : ''}
          </div>
        `;
        
        // Remove existing indicator if present
        const existing = document.getElementById('backend-status');
        if (existing) {
          existing.remove();
        }
        
        document.body.appendChild(statusIndicator);
        
        // Auto-hide after 5 seconds
        setTimeout(() => {
          if (statusIndicator.parentNode) {
            statusIndicator.remove();
          }
        }, 5000);
      }

      async updateBackendStatus() {
        try {
          // Check if user is logged in
          const user = auth.currentUser;
          
          if (user) {
            // Get authentication token
            const token = await user.getIdToken();
            apiService.setToken(token);
            
            // Test backend authentication
            try {
              const authStatus = await apiService.checkAuthStatus();
              console.log('Backend auth status:', authStatus);
              
              // Update UI based on auth status
              this.updateAuthUI(authStatus);
              
            } catch (error) {
              console.warn('Backend auth unavailable:', error?.message || error);
            }
          }
          
        } catch (error) {
          console.error('Error updating backend status:', error);
        }
      }

      updateAuthUI(authStatus) {
        // Update header buttons based on auth status
        const loginButton = document.querySelector('a[href="/webapp/login.html"]');
        const registerButton = document.querySelector('a[href="/webapp/register.html"]');
        
        if (loginButton && registerButton) {
          if (authStatus.email_verified) {
            // User is authenticated and email is verified
            loginButton.textContent = 'Mi Perfil';
            loginButton.href = '/webapp/perfil.html';
            
            registerButton.textContent = 'Explorar';
            registerButton.href = '/webapp/buscar-usuarios.html';
          }
        }
      }

      setupEventListeners() {
        // Add click listeners to main CTA buttons
        const exploreButton = document.querySelector('a[href="/webapp/buscar-usuarios.html"]');
        const registerButton = document.querySelector('a[href="/webapp/register.html"]');
        
        if (exploreButton) {
          exploreButton.addEventListener('click', async (e) => {
            e.preventDefault();
            await this.handleExploreClick();
          });
        }
        
        if (registerButton) {
          registerButton.addEventListener('click', async (e) => {
            e.preventDefault();
            await this.handleRegisterClick();
          });
        }
      }

      async handleExploreClick() {
        try {
          // Check if backend is available
          const isAvailable = await apiService.isBackendAvailable();
          
          if (isAvailable) {
            console.log('✅ Backend available - proceeding to explore users');
          } else {
            console.warn('⚠️ Backend not available - using Firebase only');
          }
          
          // Navigate to explore users
          window.location.href = '/webapp/buscar-usuarios.html';
          
        } catch (error) {
          console.error('Error handling explore click:', error);
          // Fallback to direct navigation
          window.location.href = '/webapp/buscar-usuarios.html';
        }
      }

      async handleRegisterClick() {
        try {
          // Check if backend is available
          const isAvailable = await apiService.isBackendAvailable();
          
          if (isAvailable) {
            console.log('✅ Backend available - proceeding to register');
          } else {
            console.warn('⚠️ Backend not available - using Firebase only');
          }
          
          // Navigate to register
          window.location.href = '/webapp/register.html';
          
        } catch (error) {
          console.error('Error handling register click:', error);
          // Fallback to direct navigation
          window.location.href = '/webapp/register.html';
        }
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        new IndexPageManager();
      });
    } else {
      new IndexPageManager();
    }

    // Make it available globally
    window.IndexPageManager = IndexPageManager;
  </script>

  <!-- Firebase Integration (SDK modular) -->
  <script type="module">
    import { auth } from './webapp/js/firebase-config.js';
    import { onAuthStateChanged, signInWithEmailAndPassword, signOut } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    onAuthStateChanged(auth, (user) => {
      if (user) {
        const loginButton = document.querySelector('a[href="/webapp/login.html"]');
        const registerButton = document.querySelector('a[href="/webapp/register.html"]');
        if (loginButton && registerButton) {
          loginButton.textContent = 'Mi Perfil';
          loginButton.href = '/webapp/perfil.html';
          registerButton.textContent = 'Explorar';
          registerButton.href = '/webapp/buscar-usuarios.html';
        }
      }
    });
    const g = document.getElementById('quickLoginGonzalo');
    const c = document.getElementById('quickLoginCasita');
    if (g) {
      g.addEventListener('click', async () => {
        try {
          await signOut(auth);
          await signInWithEmailAndPassword(auth, 'gonzalo.hrrj@gmail.com', 'Temporal123!');
          window.location.href = '/webapp/buscar-usuarios.html';
        } catch (e) {
          alert(e.message || 'Error');
        }
      });
    }
    if (c) {
      c.addEventListener('click', async () => {
        try {
          await signOut(auth);
          await signInWithEmailAndPassword(auth, 'lacasitadebarajas@gmail.com', 'Temporal123!');
          window.location.href = '/webapp/buscar-usuarios.html';
        } catch (e) {
          alert(e.message || 'Error');
        }
      });
    }
  </script>

</body>
</html>
